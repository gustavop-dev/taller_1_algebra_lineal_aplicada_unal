\subsection{Problema de mínimos cuadrados $\displaystyle\arg\min_{X}\|AX-XA-I\|_{\mathrm{F}}$}

Sea $A \in \mathbb{R}^{n\times n}$ (o $\mathbb{C}^{n\times n}$) fija.
Buscamos la matriz $X$ que minimice
\[
F(X)=\|AX - XA - I\|_{\mathrm{F}}^{2},
\]
donde $\|\cdot\|_{\mathrm{F}}$ es la norma de Frobenius.

\subsubsection{Proyección ortogonal sobre el conmutante}
Recordemos del \textbf{Punto 5} que
\[
\mathcal{C}(A)=\{X \colon XA = AX\}
\]
tiene una base ortonormal (producto Frobenius)  
$\{C_1,\dots,C_d\}$, obtenible con el algoritmo del \textbf{Punto 4}
(archivo \texttt{commuting\_basis.py}).  
Sea $\Pi\colon\mathbb{R}^{n\times n}\!\to\!\mathcal{C}(A)$ la proyección
ortogonal,
\[
\Pi(B)=\sum_{i=1}^{d}\langle B, C_i\rangle\,C_i,
\quad
\langle B, C_i\rangle=\operatorname{trace}(C_i^{\mathsf T}B).
\]

\paragraph{Resultado.}
$F(X)$ es estrictamente convexa; su minimizador único es
\[
X^{\star}=\Pi(I),
\]
la proyección de la identidad sobre $\mathcal{C}(A)$.  
El error mínimo es
\[
F(X^{\star})=\bigl\|I-\Pi(I)\bigr\|_{\mathrm{F}}^{2}.
\]

\subsubsection{Algoritmo práctico}
\begin{enumerate}
  \item Calcular $\{C_i\}$ con \verb|commuting_basis(A)|.
  \item Coeficientes $\alpha_i=\langle I,C_i\rangle$.
  \item $X^{\star}=\sum \alpha_i C_i$.
  \item (Opcional) comprobar $\|AX^{\star}-X^{\star}A-I\|_{\mathrm{F}}$.
\end{enumerate}

\subsubsection{Implementación en Python}
\begin{verbatim}
from commuting_basis import commuting_basis
import numpy as np

def least_squares_commuting(A):
    C = commuting_basis(A)           # ortho basis of commutant
    I = np.eye(A.shape[0])
    X = sum(np.trace(Ci.T @ I) * Ci for Ci in C)  # projection of I
    err = np.linalg.norm(A @ X - X @ A - I, 'fro')
    return X, err
\end{verbatim}

\subsubsection{Observaciones}
\begin{itemize}
  \item Si $A=\lambda I$, entonces $X^{\star}=I$ y el error es $0$.
  \item Si el espectro de $A$ es simple, igualmente $X^{\star}=I$.
  \item Para multiplicidades intermedias, $X^{\star}$ combina los
        proyectores asociados a cada subespacio propio de $A$.
\end{itemize}
